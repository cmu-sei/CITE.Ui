<!--
Copyright 2022 Carnegie Mellon University. All Rights Reserved.
 Released under a MIT (SEI)-style license, please see LICENSE.md in the project root for license information or contact permission@sei.cmu.edu for full terms.
-->

<div
  class="app-admin-container mat-elevation-z8"
  fxLayout="column"
  fxLayoutAlign="center stretch"
  fxFlexFill
>
  <app-topbar
    *ngIf="!hideTopbar"
    [title]="topbarText"
    [topbarView]="TopbarView.CITE_ADMIN"
    [topbarColor]="topbarColor"
    [topbarTextColor]="topbarTextColor"
    [imageFilePath]="topbarImage"
  ></app-topbar>

  <mat-sidenav-container fxFlex autosize>
    <mat-sidenav
      class="appbarmenu-container"
      #sidenav
      mode="side"
      [(opened)]="isSidebarOpen"
    >
      <mat-list>
        <mat-list-item class="appslist" title="Exit Administration">
          <button
            aria-label="Exit Administration"
            fxLayoutAlign="start center"
            mat-icon-button
            [routerLink]="['/']"
            [queryParams]="{evaluation: (evaluationId | async)}"
            style="outline: none"
          >
            <mat-icon
              class="mdi-24px"
              fontIcon="mdi-close-circle-outline"
            ></mat-icon>
          </button>
          <a class="nolink" [routerLink]="['/']">
            <div fxLayout="row" fxLayoutAlign="middle center">
              <h2 class="icon-text">Administration</h2>
            </div>
          </a>
          <mat-divider></mat-divider>
        </mat-list-item>
        <mat-list-item
          *ngIf="isSuperUser"
          class="showhand highlight"
          [ngClass]="getSelectedClass(evaluationsText)"
          id="wrapper"
          (click)="gotoSection(evaluationsText)"
        >
          <div class="lefticon">
            <mat-icon
              class="mdi-36px"
              fontIcon="mdi-briefcase-outline"
              [ngStyle]="{ color: topbarColor }"
            ></mat-icon>
          </div>

          <div id="evaluationsText" class="application-name">
            {{ evaluationsText }}
          </div>

          <div>
            <button aria-labelledby="evaluationsText" mat-icon-button>
              <mat-icon
                class="icon-color"
                fontIcon="mdi-chevron-right"
              ></mat-icon>
            </button>
          </div>
        </mat-list-item>
        <mat-list-item
          *ngIf="isSuperUser"
          class="showhand highlight"
          [ngClass]="getSelectedClass(scoringModelsText)"
          id="wrapper"
          (click)="gotoSection(scoringModelsText)"
        >
          <div class="lefticon">
            <mat-icon
              class="mdi-36px"
              fontIcon="mdi-grid"
              [ngStyle]="{ color: topbarColor }"
            ></mat-icon>
          </div>

          <div id="scoringModelsText" class="application-name">
            {{ scoringModelsText }}
          </div>

          <div>
            <button aria-labelledby="scoringModelsText" mat-icon-button>
              <mat-icon
                class="icon-color"
                fontIcon="mdi-chevron-right"
              ></mat-icon>
            </button>
          </div>
        </mat-list-item>
        <mat-list-item
          *ngIf="canAccessAdminSection"
          class="showhand highlight"
          [ngClass]="getSelectedClass(actionsText)"
          id="wrapper"
          (click)="gotoSection(actionsText)"
        >
          <div class="lefticon">
            <mat-icon
              class="mdi-36px"
              fontIcon="mdi-clipboard-list-outline"
              [ngStyle]="{ color: topbarColor }"
            ></mat-icon>
          </div>

          <div id="actionsText" class="application-name">
            {{ actionsText }}
          </div>

          <div>
            <button aria-labelledby="actionsText" mat-icon-button>
              <mat-icon
                class="icon-color"
                fontIcon="mdi-chevron-right"
              ></mat-icon>
            </button>
          </div>
        </mat-list-item>
        <mat-list-item
          *ngIf="canAccessAdminSection"
          class="showhand highlight"
          [ngClass]="getSelectedClass(rolesText)"
          id="wrapper"
          (click)="gotoSection(rolesText)"
        >
          <div class="lefticon">
            <mat-icon
              class="mdi-36px"
              fontIcon="mdi-clipboard-account-outline"
              [ngStyle]="{ color: topbarColor }"
            ></mat-icon>
          </div>

          <div id="rolesText" class="application-name">
            {{ rolesText }}
          </div>

          <div>
            <button aria-labelledby="rolesText" mat-icon-button>
              <mat-icon
                class="icon-color"
                fontIcon="mdi-chevron-right"
              ></mat-icon>
            </button>
          </div>
        </mat-list-item>
        <mat-list-item
          *ngIf="isSuperUser"
          class="showhand highlight"
          [ngClass]="getSelectedClass(submissionsText)"
          id="wrapper"
          (click)="gotoSection(submissionsText)"
        >
          <div class="lefticon">
            <mat-icon
              class="mdi-36px"
              fontIcon="mdi-playlist-play"
              [ngStyle]="{ color: topbarColor }"
            ></mat-icon>
          </div>

          <div id="submissionsText" class="application-name">
            {{ submissionsText }}
          </div>

          <div>
            <button aria-labelledby="submissionsText" mat-icon-button>
              <mat-icon
                class="icon-color"
                fontIcon="mdi-chevron-right"
              ></mat-icon>
            </button>
          </div>
        </mat-list-item>
        <mat-list-item
          *ngIf="isSuperUser"
          class="showhand highlight"
          [ngClass]="getSelectedClass(teamsText)"
          id="wrapper"
          (click)="gotoSection(teamsText)"
        >
          <div class="lefticon">
            <mat-icon
              class="mdi-36px"
              fontIcon="mdi-account-multiple"
              [ngStyle]="{ color: topbarColor }"
            ></mat-icon>
          </div>

          <div id="teamsText" class="application-name">
            {{ teamsText }}
          </div>

          <div>
            <button aria-labelledby="teamsText" mat-icon-button>
              <mat-icon
                class="icon-color"
                fontIcon="mdi-chevron-right"
              ></mat-icon>
            </button>
          </div>
        </mat-list-item>
        <mat-list-item
          *ngIf="isSuperUser"
          class="showhand highlight"
          [ngClass]="getSelectedClass(usersText)"
          id="wrapper"
          (click)="gotoSection(usersText)"
        >
          <div class="lefticon">
            <mat-icon
              class="mdi-36px"
              fontIcon="mdi-account"
              [ngStyle]="{ color: topbarColor }"
            ></mat-icon>
          </div>

          <div id="usersText" class="application-name">
            {{ usersText }}
          </div>

          <div>
            <button aria-labelledby="usersText" mat-icon-button>
              <mat-icon
                class="icon-color"
                fontIcon="mdi-chevron-right"
              ></mat-icon>
            </button>
          </div>
        </mat-list-item>
      </mat-list>
      <img
        class="cmu-logo"
        [src]="
          (theme$ | async) === 'light-theme'
            ? '/assets/img/cmu-red-gray.png'
            : '/assets/img/cmu-red-gray.png'
        "
      />
    </mat-sidenav>
    <mat-sidenav-content>
      <span *ngIf="isSuperUser && ((showSection | async) === scoringModelsText)">
        <app-admin-scoring-models
          [scoringModelList]="scoringModelList | async"
          [filterControl]="filterControl"
          [pageSize]="pageSize | async"
          [pageIndex]="pageIndex | async"
          [filterString]="filterString | async"
          (sortChange)="sortChangeHandler($event)"
          (pageChange)="pageChangeHandler($event)"
        >
        </app-admin-scoring-models>
      </span>
      <span *ngIf="isSuperUser && ((showSection | async) === evaluationsText)">
        <app-admin-evaluations
          [evaluationList]="evaluationList | async"
          [teamList]="teamList | async"
          [filterControl]="filterControl"
          [pageSize]="pageSize | async"
          [pageIndex]="pageIndex | async"
          [filterString]="filterString | async"
          (sortChange)="sortChangeHandler($event)"
          (pageChange)="pageChangeHandler($event)"
        >
        </app-admin-evaluations>
      </span>
      <span *ngIf="canAccessAdminSection && ((showSection | async) === actionsText)">
        <app-admin-actions
          [showSelectionControls]="canSwitchEvaluations | async"
        >
        </app-admin-actions>
      </span>
      <span *ngIf="canAccessAdminSection && ((showSection | async) === rolesText)">
        <app-admin-roles
          [showSelectionControls]="canSwitchEvaluations | async"
        >
        </app-admin-roles>
      </span>
      <span *ngIf="isSuperUser && ((showSection | async) === submissionsText)">
        <app-admin-submissions
          [filterControl]="filterControl"
          [pageSize]="pageSize | async"
          [pageIndex]="pageIndex | async"
          [filterString]="filterString | async"
          (sortChange)="sortChangeHandler($event)"
          (pageChange)="pageChangeHandler($event)"
        >
        </app-admin-submissions>
      </span>
      <span *ngIf="isSuperUser && ((showSection | async) === groupsText)">
        <app-admin-groups
          [teamList]="teamList | async"
          [filterControl]="filterControl"
          [pageSize]="pageSize | async"
          [pageIndex]="pageIndex | async"
          [filterString]="filterString | async"
          (sortChange)="sortChangeHandler($event)"
          (pageChange)="pageChangeHandler($event)"
        >
        </app-admin-groups>
      </span>
      <span *ngIf="isSuperUser && ((showSection | async) === teamsText)">
        <app-admin-teams
          [teamList]="teamList | async"
          [userList]="userList | async"
          [filterControl]="filterControl"
          [pageSize]="pageSize | async"
          [pageIndex]="pageIndex | async"
          [filterString]="filterString | async"
          (sortChange)="sortChangeHandler($event)"
          (pageChange)="pageChangeHandler($event)"
        >
        </app-admin-teams>
      </span>
      <span *ngIf="isSuperUser && ((showSection | async) === usersText)">
        <app-admin-users
          [userList]="userList | async"
          [permissionList]="permissionList | async"
          [filterControl]="filterControl"
          [pageSize]="pageSize | async"
          [pageIndex]="pageIndex | async"
          [filterString]="filterString | async"
          (removeUserPermission)="removeUserPermissionHandler($event)"
          (addUserPermission)="addUserPermissionHandler($event)"
          (addUser)="addUserHandler($event)"
          (deleteUser)="deleteUserHandler($event)"
          (sortChange)="sortChangeHandler($event)"
          (pageChange)="pageChangeHandler($event)"
        >
        </app-admin-users>
      </span>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
